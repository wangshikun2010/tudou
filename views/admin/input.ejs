<% include header %>
<div class="container">
    <form method="post" action="/admin/add" class="form-horizontal" enctype="multipart/form-data">
        <div class="form-group">
            <label for="inputEmail3" class="col-sm-1 control-label">标题</label>
            <div class="col-sm-6">
                <input type="text" class="form-control" name="title" id="inputEmail3" placeholder="请输入标题">
            </div>
        </div>
        <div class="form-group">
            <label for="inputPassword3" class="col-sm-1 control-label">描述</label>
            <div class="col-sm-6">
                <textarea class="form-control" rows="3" name="content"></textarea>
            </div>
        </div>
        <div class="form-group">
            <label for="inputPassword3" class="col-sm-1 control-label">图片</label>
            <div class="col-sm-6">
                <input type="file" name="image">
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-1 col-sm-11">
                <button type="submit" class="btn btn-default">保存</button>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
    $(function() {
        $('input:file').change(function() {
            console.log($(this).val());
        });

        $('form').ajaxForm({
            dataType: 'json',
            beforeSubmit: function(arr, $form, options) {
                // console.log(arr);
                // console.log($form);
                // console.log(options);

                if ($form.find('input:file').val() == '') {
                    alert('请上传图片');
                    return false;
                }
            },
            success: function(res, status) {
                console.log(res);
                if (res.status == 200) {
                    window.location.href = '/admin/list';
                }
            }
        });
    });
</script>
</body>
</html>